# HEAP 구현 미션

## 학습

| 개념                       | 설명                                                      |
| -------------------------- | --------------------------------------------------------- |
| **힙 (Heap)**              | 동적 메모리 할당 공간, `malloc`으로 할당 후 `free`해야 함 |
| **malloc**                 | 힙에서 메모리 할당하는 함수                               |
| **가비지 콜렉션**          | 사용되지 않는 메모리를 자동으로 해제                      |
| **스택 (Stack)**           | 함수 호출과 지역 변수를 저장하는 LIFO 구조                |
| **패딩 (Padding)**         | CPU 정렬을 위해 삽입되는 빈 공간                          |
| **포인터 (Pointer)**       | 메모리 주소를 저장하는 변수                               |
| **프로세스 메모리**        | 코드, 데이터, 힙, 스택, BSS 등으로 구성됨                 |
| **호출 스택 (Call Stack)** | 함수 호출 기록을 관리하는 스택                            |

#### 추가학습

> 동적 할당된 메모리란?
> 동적 할당이란 프로그램이 실행되는 동안(런타임)에 필요한 만큼 메모리를 확보하는 것.
> 반대로, 정적 할당은 프로그램이 실행되기 전에(컴파일할 때) 이미 크기가 정해진 메모리.

> 세그멘테이션 오류 (Segmentation Fault, SIGSEGV)
> 세그멘테이션 오류는 잘못된 메모리에 접근했을 때 발생하는 오류.
> 대표적인 원인은 NULL 포인터 접근, 배열 범위 초과, 읽기 전용 메모리 수정 등.

## 설계

### `Heap` 클래스 설계

#### 1. **Constructor**:

- 메모리 배열을 빈 배열로 선언합니다.
- `types` 속성을 추가하여, 각 타입의 정보를 객체로 저장합니다.
  => (refector)`types`는 private field로 설정하여 set,get함수가 아니면 외부에서 수정할 수 없게 합니다.
- `heap` 배열을 빈배열로 선언합니다.

#### 2. **`init` 메서드**:

- `heapSize` 매개변수를 받아, 해당 크기의 메모리 배열을 초기화합니다.
- 배열의 길이는 변하지 않으며, 각 항목은 `{ 할당여부: false }`로 초기화됩니다.
  => (refector) `{type: null, totalSize: 0, isAllocated: false}`로 초기화합니다.
- `base address`를 0x000~0xA000 사이로 지정하고, 이를 반환합니다.

#### 3. **`setSize` 메서드**:

- `type` (문자열)과 `length` (숫자)를 매개변수로 받습니다.
- 타입이 이미 존재하면 에러를 던집니다. 이를 위해 `get`과 `set` 메서드를 사용하여 타입을 수정할 수 없도록 합니다.
- `length`는 1, 2, 4, 8, 16, 32 중 하나여야 하며, 유효성 검사를 합니다.
- 타입 정보는 `types` 객체에 저장되며, 각 타입은 `length`와 함께 관리됩니다.

#### 4. **`malloc` 메서드**:

- `type` (문자열)과 `count` (숫자)를 매개변수로 받습니다.
- `types` 객체에서 `type`을 찾고, 존재하지 않으면 에러를 반환합니다.
- `length`가 8보다 작은 경우, `Math.ceil()`을 사용하여 패딩을 추가하고, 메모리를 할당합니다.
- 메모리는 기본 `length` 값을 계산하여 할당 가능한 인덱스 범위(공간)을 찾고 저장됩니다.
- 각 메모리 항목은 `{type, totalSize, isAllocated: true}` 형태로 저장됩니다.
- 할당된 메모리의 상대 주소는 `length`로 반환됩니다.

#### 5. **`free` 메서드**:

- `pointer` (상대주소)를 매개변수로 받습니다.
- `pointer`는 상대주소를 10진수로 변환하여 힙 배열의 인덱스를 찾습니다.
- 해당 인덱스에서 크기만큼 할당된 공간을 `false`로 설정하여 메모리를 해제합니다.
- slice나 splice를 쓰지 않고 단순히 할당 여부(boolean)만 변경하여 메모리를 비웁니다. (이유: 배열 인덱스 바뀔 위험 존재)
